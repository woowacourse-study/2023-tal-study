# chapter 1, 2 전체 정리

## 전체 흐름
### 1. 웹 브라우저가 메시지를 만든다
- 웹 브라우저(애플리케이션)이 메시지를 만들고, 메시지를 보내야 할 곳을 찾아서 운영 체제의 프로토콜 스택에게 송신을 의뢰한다.
    - DNS 서버를 조회해 URL의 도메인명에 맞는 수신처의 IP 주소를 조사한다.
    - 애플리케이션의 아래 부분에 있는 소켓 라이브러리는 네트워크의 기능을 호출하기 위한 프로그램의 부품집이다.
    - 네임 리졸루션, 프로토콜 스택에 송수신을 의뢰할 때 모두 소켓 라이브러리의 부품을 이용한다.

### 2. TCP/IP의 데이터를 전기 신호로 만들어 보낸다
- 프로토콜 스택이 데이터를 전기 신호로 만들어 보낸다.
    - 프로토콜 스택은 네트워크 제어용 소프트웨어이다.
        - 데이터 송수신을 담당하는 TCP 프로토콜과 UDP 프로토콜, 그리고 그 아래 계층에 패킷 송수신을 담당하는 IP 프로토콜로 이루어져 있다.
        - 브라우저에게 받은 메시지를 패킷에 저장하고 수신처 주소 등의 제어 정보를 덧붙인다.
        - 또, 통신의 기본을 조절하고(데이터 크기 및 타이밍 등) 오류 검출, 패킷을 고쳐서 보내는 등의 다양한 역할을 한다.
            - TCP의 경우 통신 동작을 위해 클라이언트와 서버 간 제어 정보를 주고 받는 식으로 논리적 연결을 이룬다.
    - TCP 담당 부분이 TCP 헤더를, IP 담당 부분이 IP 헤더와 MAC 헤더를 붙인 뒤 디지털 데이터로 변환한 패킷을 LAN 어댑터에게 넘겨준다.
        - IP 헤더에 담긴 송신처 IP 주소로, 어느 LAN 어댑터에게 건네줄지 판단한다.
        - IP 헤더에 담긴 수신처 IP 주소로, 통신 상대의 주소를 판단한다.
        - MAC 헤더는, 이더넷의 수신처 판단 구조로 사용하기 위해 붙인다. (이더넷은 TCP/IP와 다른 구조임)
            - IP 주소로 MAC 주소를 알기 위해서는 ARP 프로토콜을 사용한다.
    - 네트워크용 하드웨어인 LAN 어댑터가 디지털 데이터를 전기 신호로 바꾸어 케이블로 송출한다.

## 조금 더 자세히 살펴보기

### TCP의 접속, 연결끊기, 송/수신 동작
TCP는 논리적인 접속을 성립하거나 종료하기 위해, 클라이언트와 서버 간 제어 정보를 주고 받는다.
- 접속 동작 : 3-way Handshaking
    - 클라이언트가 `SYN(1), 시퀀스 번호 초기값, 윈도우`를 보냄
    - 서버가 `ACK 번호, 윈도우, SYN(1), 시퀀스 번호 초기값`을 보냄
    - 클라이언트가 `ACK 번호`를 보냄
- 연결 끊기 동작 : 4-way Handshaking
    - 서버가 `FIN(1)`을 보냄
    - 클라이언트가 `ACK 번호`를 보냄
    - 클라이언트가 `FIN(1)`을 보냄
    - 서버가 `ACK 번호`를 보냄
- 송/수신 동작
    - 데이터를 송신하는 측에서 `시퀀스 번호와 데이터`를 보내면, 수신하는 측에서 `ACK 번호와 윈도우`를 보내는 것을 반복한다.

- `시퀀스 번호`는 송신측에서 데이터 조각이 통신 개시부터 몇 번째 바이트에 해당하는지를 세어둔 값
- `ACK 번호는`는 수신측에서 이전에 수신한 데이터와 합쳐서, 총 몇 번째 바이트까지 데이터를 수신했는지 계산한 값
- `SYN`은 초기값(접속 동작)을 통지하는 제어 비트
- 위와 같은 통신 동작을 할 때 타임아웃 값 이내에 ACK 번호가 돌아오지 않으면, 패킷을 다시 보낸다.
- 윈도우 제어 방식을 이용해 효율적으로 ACK 번호를 관리한다.

### 이더넷
이더넷은 다수의 컴퓨터가 여러 상대와 자유롭게, 적은 비용으로 통신하기 위해 고안된 통신 기술이다.
- MAC 헤더의 수신처 MAC 주소에 기억된 상대에게 패킷을 전달한다.
- 송신처 MAC 주소로 송신처를 나타낸다.
- 이더 타입으로 패킷의 내용물을 나타낸다.

사실상 원형은 케이블만 있는 것이고, 리피터 허브나 스위칭 허브를 이용한 형태로 발전했다.
현재 이더넷이라고 말하면 스위칭 허브 형태를 가리킨다.

이더넷의 원형, 리피터 허브를 이용한 파생형의 경우 모두에게 신호를 보내 해당하는 기기가 패킷을 수신하고 나머지는 패킷을 폐기한다.  
스위칭 허브의 경우 수신처 MAC 주소로 나타내는, 원하는 기기가 존재하는 부분에만 신호가 흐른다.  
